import { Mesh } from "./mesh.js";
import { cubicPatchToMesh } from "./patch.js";
import { Vec3 } from "./vector.js";

const teapotPoints: Vec3[] = [
  [11, 0, 9],
  [11, -6, 9],
  [6, -11, 9],
  [0, -11, 9],
  [11, 0, 10],
  [11, -6, 10],
  [6, -11, 10],
  [0, -11, 10],
  [12, 0, 10],
  [12, -6, 10],
  [12, 0, 9],
  [12, -7, 9],
  [7, -12, 9],
  [0, -12, 9],
  [-6, -11, 9],
  [-11, -6, 9],
  [-11, 0, 9],
  [-6, -11, 10],
  [-11, -6, 10],
  [-11, 0, 10],
  [-7, -12, 9],
  [-12, -7, 9],
  [-12, 0, 9],
  [-11, 6, 9],
  [-6, 11, 9],
  [0, 11, 9],
  [-11, 6, 10],
  [-6, 11, 10],
  [0, 11, 10],
  [-6, 12, 10],
  [0, 12, 10],
  [-12, 7, 9],
  [-7, 12, 9],
  [0, 12, 9],
  [6, 11, 9],
  [11, 6, 9],
  [6, 11, 10],
  [11, 6, 10],
  [6, 12, 10],
  [12, 6, 10],
  [7, 12, 9],
  [12, 7, 9],
  [14, 0, 5],
  [14, -8, 5],
  [8, -14, 5],
  [0, -14, 5],
  [16, 0, 1],
  [16, -9, 1],
  [9, -16, 1],
  [0, -16, 1],
  [16, 0, -3],
  [16, -9, -3],
  [9, -16, -3],
  [0, -16, -3],
  [-8, -14, 5],
  [-14, -8, 5],
  [-14, 0, 5],
  [-9, -16, 1],
  [-16, -9, 1],
  [-16, 0, 1],
  [-9, -16, -3],
  [-16, -9, -3],
  [-16, 0, -3],
  [-14, 8, 5],
  [-8, 14, 5],
  [0, 14, 5],
  [-16, 9, 1],
  [-9, 16, 1],
  [0, 16, 1],
  [-16, 9, -3],
  [-9, 16, -3],
  [0, 16, -3],
  [8, 14, 5],
  [14, 8, 5],
  [9, 16, 1],
  [16, 9, 1],
  [9, 16, -3],
  [16, 9, -3],
  [16, 0, -6],
  [16, -9, -6],
  [9, -16, -6],
  [0, -16, -6],
  [12, 0, -8],
  [12, -7, -8],
  [7, -12, -8],
  [0, -12, -8],
  [12, 0, -9],
  [12, -7, -9],
  [7, -12, -9],
  [0, -12, -9],
  [-9, -16, -6],
  [-16, -9, -6],
  [-16, 0, -6],
  [-7, -12, -8],
  [-12, -7, -8],
  [-12, 0, -8],
  [-7, -12, -9],
  [-12, -7, -9],
  [-12, 0, -9],
  [-16, 9, -6],
  [-9, 16, -6],
  [0, 16, -6],
  [-12, 7, -8],
  [-7, 12, -8],
  [0, 12, -8],
  [-12, 7, -9],
  [-7, 12, -9],
  [0, 12, -9],
  [9, 16, -6],
  [16, 9, -6],
  [7, 12, -8],
  [12, 7, -8],
  [7, 12, -9],
  [12, 7, -9],
  [-13, 0, 6],
  [-13, -2, 6],
  [-12, -2, 8],
  [-12, 0, 8],
  [-18, 0, 6],
  [-18, -2, 6],
  [-20, -2, 8],
  [-20, 0, 8],
  [-22, 0, 6],
  [-22, -2, 6],
  [-24, -2, 8],
  [-24, 0, 8],
  [-22, 0, 4],
  [-22, -2, 4],
  [-24, -2, 4],
  [-24, 0, 4],
  [-12, 2, 8],
  [-13, 2, 6],
  [-20, 2, 8],
  [-18, 2, 6],
  [-24, 2, 8],
  [-22, 2, 6],
  [-24, 2, 4],
  [-22, 2, 4],
  [-22, 0, 3],
  [-22, -2, 3],
  [-24, -2, 1],
  [-24, 0, 1],
  [-20, 0, -1],
  [-20, -2, -1],
  [-21, -2, -2],
  [-21, 0, -2],
  [-16, -2, -3],
  [-15, -2, -5],
  [-15, 0, -5],
  [-24, 2, 1],
  [-22, 2, 3],
  [-21, 2, -2],
  [-20, 2, -1],
  [-15, 2, -5],
  [-16, 2, -3],
  [14, 0, 1],
  [14, -5, 1],
  [14, -5, -5],
  [14, 0, -5],
  [21, 0, 1],
  [21, -5, 1],
  [25, -5, -3],
  [25, 0, -3],
  [18, 0, 7],
  [18, -2, 7],
  [19, -2, 6],
  [19, 0, 6],
  [22, 0, 9],
  [22, -2, 9],
  [26, -2, 9],
  [26, 0, 9],
  [14, 5, -5],
  [14, 5, 1],
  [25, 5, -3],
  [21, 5, 1],
  [19, 2, 6],
  [18, 2, 7],
  [26, 2, 9],
  [22, 2, 9],
  [22, 0, 10],
  [22, -2, 10],
  [28, -2, 10],
  [28, 0, 10],
  [23, 0, 10],
  [23, -1, 10],
  [28, -1, 10],
  [22, -1, 9],
  [26, -1, 9],
  [28, 2, 10],
  [22, 2, 10],
  [28, 1, 10],
  [23, 1, 10],
  [26, 1, 9],
  [22, 1, 9],
  [0, 0, 15],
  [6, 0, 15],
  [6, -4, 15],
  [4, -6, 15],
  [0, -6, 15],
  [0, 0, 13],
  [2, 0, 12],
  [2, -1, 12],
  [1, -2, 12],
  [0, -2, 12],
  [-4, -6, 15],
  [-6, -4, 15],
  [-6, 0, 15],
  [-1, -2, 12],
  [-2, -1, 12],
  [-2, 0, 12],
  [-6, 4, 15],
  [-4, 6, 15],
  [0, 6, 15],
  [-2, 1, 12],
  [-1, 2, 12],
  [0, 2, 12],
  [4, 6, 15],
  [6, 4, 15],
  [1, 2, 12],
  [2, 1, 12],
  [3, 0, 10],
  [3, -2, 10],
  [2, -3, 10],
  [0, -3, 10],
  [10, 0, 10],
  [10, -6, 10],
  [6, -10, 10],
  [0, -10, 10],
  [10, 0, 9],
  [10, -6, 9],
  [6, -10, 9],
  [0, -10, 9],
  [-2, -3, 10],
  [-3, -2, 10],
  [-3, 0, 10],
  [-6, -10, 10],
  [-10, -6, 10],
  [-10, 0, 10],
  [-6, -10, 9],
  [-10, -6, 9],
  [-10, 0, 9],
  [-3, 2, 10],
  [-2, 3, 10],
  [0, 3, 10],
  [-10, 6, 10],
  [-6, 10, 10],
  [0, 10, 10],
  [-10, 6, 9],
  [-6, 10, 9],
  [0, 10, 9],
  [2, 3, 10],
  [3, 2, 10],
  [6, 10, 10],
  [10, 6, 10],
  [6, 10, 9],
  [10, 6, 9],
  [0, 0, -10],
  [11, 0, -10],
  [11, 6, -10],
  [6, 11, -10],
  [0, 11, -10],
  [-6, 11, -10],
  [-11, 6, -10],
  [-11, 0, -10],
  [-11, -6, -10],
  [-6, -11, -10],
  [0, -11, -10],
  [6, -11, -10],
  [11, -6, -10],
];

const teapotPatchIndexes = [
  [
    [0, 1, 2, 3],
    [4, 5, 6, 7],
    [8, 9, 6, 7],
    [10, 11, 12, 13],
  ],
  [
    [3, 14, 15, 16],
    [7, 17, 18, 19],
    [7, 17, 18, 19],
    [13, 20, 21, 22],
  ],
  [
    [16, 23, 24, 25],
    [19, 26, 27, 28],
    [19, 26, 29, 30],
    [22, 31, 32, 33],
  ],
  [
    [25, 34, 35, 0],
    [28, 36, 37, 4],
    [30, 38, 39, 8],
    [33, 40, 41, 10],
  ],
  [
    [10, 11, 12, 13],
    [42, 43, 44, 45],
    [46, 47, 48, 49],
    [50, 51, 52, 53],
  ],
  [
    [13, 20, 21, 22],
    [45, 54, 55, 56],
    [49, 57, 58, 59],
    [53, 60, 61, 62],
  ],
  [
    [22, 31, 32, 33],
    [56, 63, 64, 65],
    [59, 66, 67, 68],
    [62, 69, 70, 71],
  ],
  [
    [33, 40, 41, 10],
    [65, 72, 73, 42],
    [68, 74, 75, 46],
    [71, 76, 77, 50],
  ],
  [
    [50, 51, 52, 53],
    [78, 79, 80, 81],
    [82, 83, 84, 85],
    [86, 87, 88, 89],
  ],
  [
    [53, 60, 61, 62],
    [81, 90, 91, 92],
    [85, 93, 94, 95],
    [89, 96, 97, 98],
  ],
  [
    [62, 69, 70, 71],
    [92, 99, 100, 101],
    [95, 102, 103, 104],
    [98, 105, 106, 107],
  ],
  [
    [71, 76, 77, 50],
    [101, 108, 109, 78],
    [104, 110, 111, 82],
    [107, 112, 113, 86],
  ],
  [
    [114, 115, 116, 117],
    [118, 119, 120, 121],
    [122, 123, 124, 125],
    [126, 127, 128, 129],
  ],
  [
    [117, 130, 131, 114],
    [121, 132, 133, 118],
    [125, 134, 135, 122],
    [129, 136, 137, 126],
  ],
  [
    [126, 127, 128, 129],
    [138, 139, 140, 141],
    [142, 143, 144, 145],
    [62, 146, 147, 148],
  ],
  [
    [129, 136, 137, 126],
    [141, 149, 150, 138],
    [145, 151, 152, 142],
    [148, 153, 154, 62],
  ],
  [
    [155, 156, 157, 158],
    [159, 160, 161, 162],
    [163, 164, 165, 166],
    [167, 168, 169, 170],
  ],
  [
    [158, 171, 172, 155],
    [162, 173, 174, 159],
    [166, 175, 176, 163],
    [170, 177, 178, 167],
  ],
  [
    [167, 168, 169, 170],
    [179, 180, 181, 182],
    [183, 184, 185, 182],
    [167, 186, 187, 170],
  ],
  [
    [170, 177, 178, 167],
    [182, 188, 189, 179],
    [182, 190, 191, 183],
    [170, 192, 193, 167],
  ],
  [
    [194, 194, 194, 194],
    [195, 196, 197, 198],
    [199, 199, 199, 199],
    [200, 201, 202, 203],
  ],
  [
    [194, 194, 194, 194],
    [198, 204, 205, 206],
    [199, 199, 199, 199],
    [203, 207, 208, 209],
  ],
  [
    [194, 194, 194, 194],
    [206, 210, 211, 212],
    [199, 199, 199, 199],
    [209, 213, 214, 215],
  ],
  [
    [194, 194, 194, 194],
    [212, 216, 217, 195],
    [199, 199, 199, 199],
    [215, 218, 219, 200],
  ],
  [
    [200, 201, 202, 203],
    [220, 221, 222, 223],
    [224, 225, 226, 227],
    [228, 229, 230, 231],
  ],
  [
    [203, 207, 208, 209],
    [223, 232, 233, 234],
    [227, 235, 236, 237],
    [231, 238, 239, 240],
  ],
  [
    [209, 213, 214, 215],
    [234, 241, 242, 243],
    [237, 244, 245, 246],
    [240, 247, 248, 249],
  ],
  [
    [215, 218, 219, 200],
    [243, 250, 251, 220],
    [246, 252, 253, 224],
    [249, 254, 255, 228],
  ],
  [
    [256, 256, 256, 256],
    [257, 258, 259, 260],
    [86, 113, 112, 107],
    [86, 113, 112, 107],
  ],
  [
    [256, 256, 256, 256],
    [260, 261, 262, 263],
    [107, 106, 105, 98],
    [107, 106, 105, 98],
  ],
  [
    [256, 256, 256, 256],
    [263, 264, 265, 266],
    [98, 97, 96, 89],
    [98, 97, 96, 89],
  ],
  [
    [256, 256, 256, 256],
    [266, 267, 268, 257],
    [89, 88, 87, 86],
    [89, 88, 87, 86],
  ],
];

export function createTeapotMeshes(divisions: number): Mesh[] {
  return teapotPatchIndexes.map((controlPoints) =>
    cubicPatchToMesh(
      controlPoints.map((row) => row.map((idx) => teapotPoints[idx])),
      divisions,
      divisions,
    ),
  );
}
